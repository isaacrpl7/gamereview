{% extends "base.html" %}
{% block title %}
    Lista das Reviews
{% endblock title %}
{% block content %}

    {% load extras %}
    <h1>Reviews dos jogos</h1>
    
    <form method="get">
        {{myFilter.form}}
    <button class="btn btn-primary" type="submit">Buscar</button>
    </form>

    <table id="game-table" class="table table-bordered table-sm" cellspacing="0" width="100%">
        <thead class="border-bottom font-weight-bold">
            <tr>
                <th class="th-sm">Numero</th>
                <th class="th-sm">Data de lançamento</th>
                <th class="th-sm">Jogo</th>
                <th class="th-sm">Preço</th>
                <th class="th-sm">Jogadores</th>
                <th class="th-sm">Desenvolvedor</th>
                <th class="th-sm">Publicador</th>
                <th class="th-sm">Tempo medio de jogo</th>
                <th class="th-sm">Tempo mediano de jogo</th>
                <th class="th-sm">Metascore</th>
                <th class="th-sm">Ações</th>
            </tr>
        </thead>

        <tbody>
            {% for object in page_obj %}
                <tr>
                    <td>{{object.number}}</td>
                    <td>{{object.game}}</td>
                    <td>{{object.release_date}}</td>
                    <td>{{object.price}}</td>
                    <td>{{object.owners}}</td>
                    <td>{{object.developer}}</td>
                    <td>{{object.publisher}}</td>
                    <td>{{object.average_playtime}}</td>
                    <td>{{object.median_playtime}}</td>
                    <td>{{object.metascore}}</td>
                    <td>
                        Botoes de ações
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="pagination">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="{% my_url 1 'page' request.GET.urlencode %}">&laquo; primeira</a>
                <a href="{% my_url page_obj.previous_page_number 'page' request.GET.urlencode %}">anterior</a>
            {% endif %}

            <span class="current">
                Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}.
            </span>

            {% if page_obj.has_next %}
                <a href="{% my_url page_obj.next_page_number 'page' request.GET.urlencode %}">próxima</a>
                <a href="{% my_url page_obj.paginator.num_pages 'page' request.GET.urlencode %}">última &raquo;</a>
            {% endif %}
        </span>
    </div>
    
    <script>
        $(document).ready(function () {
        });
        function searchFunction() {
            // Declare variables
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("search-input");
            filter = input.value.toUpperCase();
            table = document.getElementById("game-table");
            tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
                }
            }
        }
    </script>
{% endblock content %}